<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
<p id="oData">ORIENTATION DATA: </p>
<p id="mData">MOTION DATA:</p>
</body>
<script src="libraries/three.min.js"></script>
<script>
var viewAngle = 75;
var aspectRatio = window.innerWidth / window.innerHeight;
var near = 1;
var far = 1000;
var cam = new THREE.PerspectiveCamera(viewAngle, aspectRatio, near, far);
var scene = new THREE.Scene();
var renderer = new THREE.WebGLRenderer();
var cube;

renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

var ptLight = new THREE.PointLight(0xFFFFFF);

init();
animatedRender();

function Vec3(x, y, z){
	return new THREE.Vector3(x,y,z);
};

function init(){
	ptLight.position.x = 100;
	ptLight.position.y = 100;
	ptLight.position.z = 200;
	scene.add(ptLight);

	cam.position.z = 50 + yAccel;
	cam.lookAt(Vec3(0,0,0));
	scene.add(cam);

	createCube();
	scene.add(cube);

}

var onOrientationChange = function(data){ 
	var oText = "ORIENTATION DATA: <br />";

	oText += "Alpha (yaw): " + data.alpha + "<br />";
	oText += "Beta (pitch): " + data.beta + "<br />";
	oText += "Gamma (roll): " + data.gamma + "<br />";

	document.getElementById("oData").innerHTML = oText; 
};

//if this browser / device can detect device orientation events...
if (window.DeviceOrientationEvent){
	window.addEventListener('deviceorientation',onOrientationChange,false);
} else {
	console.log("ERROR: This browser can't detect orientation events");
}

var xAccel = 0;
var yAccel = 0;
var zAccel = 0;

//function called when decive motion data updates
var latestMData;
var onDeviveMotion = function(data){
	latestMData = data;

	var mText = "MOTION DATA: <br />";

	mText += "Acceleration x: " + data.acceleration.x + "<br />";
	mText += "Acceleration y: " + data.acceleration.y + "<br />";
	mText += "Acceleration z: " + data.acceleration.z + "<br />";

	document.getElementById("mData").innerHTML = mText;

	xAccel = data.alpha;
	yAccel = data.beta;
	zAccel = data.gamma;
}

function createCube(){

	var geometry = new THREE.BoxGeometry(10, 10, 10);
	var material = new THREE.MeshStandardMaterial({color: 0xFFFFFF});
	cube = new THREE.Mesh(geometry, material);
	cube.position.x = 0;
	cube.position.y = 0;
	cube.position.z = 0;
	cube.updateMatrix();
}

function animatedRender(){
	requestAnimationFrame(animatedRender);
	renderer.render(scene, cam);
	cube.rotation.x += 0.01;
	cube.rotation.y += 0.01;
}

//setting up our webpage/ app to handle pre-existing js/html5 events
if (window.DeviceMotionEvent){
	window.addEventListener('devicemotion', onDeviveMotion, false)
} else {
	console.log("ERROR: browser cant detet device motion");
}

</script>
</html>